{
  "title": "Phoenix LiveView Cursors",
  "publishedAt": "2022-03-15",
  "image": {
    "src": "/static/screenshots/phoenix-live-cursors.jpg",
    "alt": "Screenshot of the end result",
    "width": 2152,
    "height": 1372,
    "showAsHeader": false
  },
  "summary": "Part 2 of my tutorial creating \"live cursors\" as seen in Figma. In this tutorial, I'll be using Phoenix LiveView to create the same feature.",
  "tags": [
    "article",
    "elixir",
    "phoenix",
    "liveview",
    "presence",
    "tailwind",
    "tutorial"
  ],
  "tagsAsSlugs": [
    "article",
    "elixir",
    "phoenix",
    "liveview",
    "presence",
    "tailwind",
    "tutorial"
  ],
  "slug": "phoenix-liveview-cursors",
  "code": "var Component=(()=>{var m=Object.create;var i=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var w=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),f=(a,e)=>{for(var c in e)i(a,c,{get:e[c],enumerable:!0})},o=(a,e,c,l)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let s of N(e))!g.call(a,s)&&s!==c&&i(a,s,{get:()=>e[s],enumerable:!(l=u(e,s))||l.enumerable});return a};var y=(a,e,c)=>(c=a!=null?m(k(a)):{},o(e||!a||!a.__esModule?i(c,\"default\",{value:a,enumerable:!0}):c,a)),v=a=>o(i({},\"__esModule\",{value:!0}),a);var d=w((L,r)=>{r.exports=_jsx_runtime});var x={};f(x,{default:()=>p,frontmatter:()=>b});var n=y(d()),b={title:\"Phoenix LiveView Cursors\",publishedAt:\"2022-03-15\",image:{src:\"/static/screenshots/phoenix-live-cursors.jpg\",alt:\"Screenshot of the end result\",width:2152,height:1372,showAsHeader:!1},summary:`Part 2 of my tutorial creating \"live cursors\" as seen in Figma. In this tutorial, I'll be using Phoenix LiveView to create the same feature.`,tags:[\"article\",\"elixir\",\"phoenix\",\"liveview\",\"presence\",\"tailwind\",\"tutorial\"]};function h(a){let e={a:\"a\",code:\"code\",em:\"em\",h2:\"h2\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...a.components},{Disclaimer:c,Image:l,Waypoint:s}=e;return c||t(\"Disclaimer\",!0),l||t(\"Image\",!0),s||t(\"Waypoint\",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"In my \",(0,n.jsx)(e.a,{href:\"/blog/phoenix-live-cursors\",children:\"previous tutorial\"}),` I created a feature called \"live cursors\" using Phoenix Channels and Presence. In this tutorial, I'll create the same functionality using `,(0,n.jsx)(e.a,{href:\"https://hexdocs.pm/phoenix_live_view/Phoenix.LiveView.html\",children:(0,n.jsx)(e.strong,{children:\"Phoenix LiveView\"})}),\". LiveView is a relatively new feature in Phoenix and a lot of people are very excited about it. If you've followed along in the previous tutorial you'll discover how much simpler and more readable the implementation becomes when using LiveView.\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"what-were-building\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#what-were-building\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"What we're building\"]}),`\n`,(0,n.jsx)(e.p,{children:\"We'll be building a simple, but compelling software feature I've seen in the design tools like Figma. In Figma, you can see the mouse cursors of other users working on the document. It's a cool functionality and Phoenix LiveView was made for this!\"}),`\n`,(0,n.jsx)(e.p,{children:\"The feature works like this: when users visit the website, they're automatically added to a web socket channel, get assigned a user name (with a corresponding color) and can send messages to other users using the input field. The result of this tutorial will look like this:\"}),`\n`,(0,n.jsx)(l,{alt:\"Screenshot of the end result\",src:\"/static/screenshots/phoenix-live-cursors.jpg\",width:2152,height:1372,priority:!0}),`\n`,(0,n.jsxs)(e.h2,{id:\"getting-started\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#getting-started\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Getting started\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Create a new Phoenix project using the command line. We don't need a database to get started, so we'll not add Ecto:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"language-bash code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`mix phx.new liveview_cursors --no-ecto\n`})})}),`\n`,(0,n.jsx)(c,{children:(0,n.jsxs)(e.p,{children:[\"Note: you can also follow along \",(0,n.jsx)(e.a,{href:\"https://github.com/vnglst/phoenix_cursors/commits/main\",children:`on\nGithub`}),`. I've created\nwaypoints after every step of the tutorial. Every waypoint is a commit on\nGithub.`]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"We'll be using Tailwind CSS for styling and you can quickly add that to the project using the official installer. You can read about the steps to follow in \",(0,n.jsx)(e.a,{href:\"/blog/adding-tailwind-to-phoenix\",children:\"my earlier tutorial\"}),\". All the changes I made to get Tailwind to work are also in \",(0,n.jsx)(e.a,{href:\"https://github.com/vnglst/liveview_cursors/commit/a680d3f849de34710d902ae2777fd99b86c0f6dc\",children:\"this commit\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"You can see the results so far by running:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"language-bash code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`mix phx.server\n`})})}),`\n`,(0,n.jsx)(e.p,{children:\"This should show a browser window with a nice wallpaper filled with ice creams, hamburgers and french fries. Now that we have a working Phoenix project with Tailwind CSS, let's start building the application.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"using-a-liveview-to-show-a-cursor\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#using-a-liveview-to-show-a-cursor\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Using a LiveView to show a cursor\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"To add our first LiveView to the application we have to implement a new \",(0,n.jsx)(e.code,{children:\"live\"}),\" route in our \",(0,n.jsx)(e.code,{children:\"router.ex\"}),\" file.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  scope \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    pipe_through \",(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":browser\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    get \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"PageController\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":index\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    live \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/cursors\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Cursors\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Next, in the folder \",(0,n.jsx)(e.code,{children:\"lib/liveview_cursors_web/live\"}),\", create a file \",(0,n.jsx)(e.code,{children:\"cursors.ex\"}),\" with the following code. This'll be our LiveView.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"defmodule\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Cursors\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"use\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":live_view\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mount\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"_params\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" _session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    updated \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`      socket\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":x\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"50\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":y\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"50\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":ok\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" updated\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"render\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"assigns\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    ~\",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"\"\"\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    <ul class=\"list-none\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token string\",children:['      <li style={\"color: deeppink; left: ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@x\"}),(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),\"%; top: \",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@y\"}),(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),`%\"} class=\"flex flex-col absolute pointer-events-none whitespace-nowrap overflow-hidden\">\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <svg\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        version=\"1.1\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        width=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        height=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        xmlns=\"http://www.w3.org/2000/svg\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        viewBox=\"0 0 21 21\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          fill=\"black\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          points=\"8.2,20.9 8.2,4.9 19.8,16.5 13,16.5 12.6,16.6\" />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          fill=\"currentColor\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          points=\"9.2,7.3 9.2,18.5 12.2,15.6 12.6,15.5 17.4,15.5\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        </svg>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      </li>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    </ul>\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'    \"\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Start the server and open the browser to the \",(0,n.jsx)(e.code,{children:\"/cursors\"}),\" route. In the middle of the screen, you should see a static pink cursor. We've given it a static position (of 50%) in the \",(0,n.jsx)(e.code,{children:\"mount\"}),\" function, but we're not updating it yet. That's no fun, of course, so let's make it more dynamic.\"]}),`\n`,(0,n.jsx)(s,{href:\"https://github.com/vnglst/liveview_cursors/commit/9c02ea98ac6ad6ddabf1b96f4bc17d42afae66e4\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"tracking-cursor-movements\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#tracking-cursor-movements\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Tracking cursor movements\"]}),`\n`,(0,n.jsx)(e.p,{children:\"The idea of LiveView is to do as much of the work on the server, but in some cases, this is not possible. In our example, we want to keep track of mouse movements on the client and send these to the server. You can't do that without at least some JavaScript.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"As an escape hatch Phoenix offers so-called \",(0,n.jsx)(e.strong,{children:\"client hooks\"}),\" with the \",(0,n.jsx)(e.code,{children:\"phx-hook\"}),\" binding. These hooks are initialized on the client and allow us to write JavaScript to send events to the server. In our case, we'll use the hook to listen to \",(0,n.jsx)(e.code,{children:\"mousemove\"}),\" events and send the changed coordinates to the server. In \",(0,n.jsx)(e.code,{children:\"assets/js/app.js\"}),\" add the following code:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"let\"}),\" csrfToken \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token dom variable\",children:\"document\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"querySelector\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"meta[name='csrf-token']\"`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"getAttribute\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'content'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"let\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Hooks\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Hooks\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"TrackClientCursor\"})}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mounted\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token dom variable\",children:\"document\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"addEventListener\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'mousemove'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"e\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"pageX\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),\" \",(0,n.jsx)(e.span,{className:\"token dom variable\",children:\"window\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"innerWidth\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// in %\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" y \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"e\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"pageY\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),\" \",(0,n.jsx)(e.span,{className:\"token dom variable\",children:\"window\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"innerHeight\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// in %\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"pushEvent\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'cursor-move'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" y \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"let\"}),\" liveSocket \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"LiveSocket\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'/live'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Socket\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"hooks\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Hooks\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"params\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"_csrf_token\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" csrfToken \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"To activate a hook in our LiveView template, we have to specify the hook name in the \",(0,n.jsx)(e.code,{children:\"phx-hook\"}),\" binding. In our case, it doesn't matter to which element we bind it. Make sure to add an id to the element so that LiveView can identify it. We also need to handle the events coming from the client. In our LiveView file \",(0,n.jsx)(e.code,{children:\"cursors.ex\"}),\" make the following changes:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"defmodule\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Cursors\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"use\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":live_view\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mount\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"_params\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" _session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    updated \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`      socket\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":x\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"50\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":y\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"50\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":ok\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" updated\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"handle_event\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"cursor-move\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"x\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    updated \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:`      socket\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":x\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":y\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":noreply\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" updated\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"render\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"assigns\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    ~\",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"\"\"\n`})]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    <ul class=\"list-none\" id=\"cursors\" phx-hook=\"TrackClientCursor\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsxs)(e.span,{className:\"token string\",children:['      <li style={\"color: deeppink; left: ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@x\"}),(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),\"%; top: \",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@y\"}),(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),`%\"} class=\"flex flex-col absolute pointer-events-none whitespace-nowrap overflow-hidden\">\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <svg\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        version=\"1.1\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        width=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        height=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        xmlns=\"http://www.w3.org/2000/svg\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        viewBox=\"0 0 21 21\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          fill=\"black\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          points=\"8.2,20.9 8.2,4.9 19.8,16.5 13,16.5 12.6,16.6\" />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          fill=\"currentColor\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          points=\"9.2,7.3 9.2,18.5 12.2,15.6 12.6,15.5 17.4,15.5\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        </svg>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      </li>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    </ul>\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'    \"\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"If you start the server and open the browser again, you should see a pink cursor following your mouse movements.\"}),`\n`,(0,n.jsx)(s,{href:\"https://github.com/vnglst/liveview_cursors/commit/5ceb53e1c94091ec4f07b7f81294b05c8a7d6851\"}),`\n`,(0,n.jsx)(l,{alt:\"Screenshot of the cursor on the client\",src:\"/static/screenshots/phoenix-liveview-hook.jpg\",width:1060,height:1064}),`\n`,(0,n.jsxs)(e.h2,{id:\"identifying-users\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#identifying-users\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Identifying users\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Showing a copy of your mouse cursor is nothing special. We want to be able to broadcast this information to every user in the channel and \",(0,n.jsx)(e.em,{children:\"at the same time\"}),\" keep track of who's in that channel. To make that happen we first need to be able to identify our users.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"We'll substitute real authentication with a simplified flow like this: When a user visits the website, a session is automatically created by assigning a random name to a user. After the session is created, we'll redirect to the \",(0,n.jsx)(e.code,{children:\"/cursors\"}),\" route. There we can retrieve the user name from the session and display it under the cursor.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Let's start with a utility function that generates a random name. Create the following file \",(0,n.jsx)(e.code,{children:\"lib/liveview_cursors/names.ex\"}),\":\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"defmodule\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Name\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" generate \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    title \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"~w(Sir Sr Prof Saint Ibn Lady Madam Mistress Herr Dr)\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Enum\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"random\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    name \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:\"~w(B C D F G H J K L M N P Q R S T V W X Z)\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:\"~w(o a i ij e ee u uu oo aj aa oe ou eu)\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:\"~w(b c d f g h k l m n p q r s t v w x z)\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:\"~w(o a i ij e ee u uu oo aj aa oe ou eu)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Enum\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" l \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Enum\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"random\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"l\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Enum\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"join\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token string\",children:['\"',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"title\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),\" \",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"name\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),'\"']}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Next, update the controller for the root route to create a new session if there is none. After that redirect the user to the \",(0,n.jsx)(e.code,{children:\"/cursors\"}),\" route. In \",(0,n.jsx)(e.code,{children:\"page_controller.ex\"}),\" update the code to the following:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"defmodule\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"PageController\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"use\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":controller\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"index\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" _params\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    session \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" conn \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"get_session\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" session \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"user\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" _user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:`        conn\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"redirect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"to:\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/cursors\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      _ \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:`        conn\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"put_session\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":user\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"generate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"configure_session\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"renew:\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"redirect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"to:\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/cursors\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"In our LiveView we also have to make sure a user has a valid session by checking if the \",(0,n.jsx)(e.code,{children:\"user\"}),\" key is present. If it is, we'll display that name under the cursor. Make the following changes in \",(0,n.jsx)(e.code,{children:\"cursors.ex\"}),\":\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"defmodule\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Cursors\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"use\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":live_view\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mount\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"_params\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"user\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    updated \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`      socket\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":x\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"50\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":y\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"50\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":user\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":ok\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" updated\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# if no user name, redirect to root to generate one\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mount\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"_params\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" _session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":ok\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"redirect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"to:\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"handle_event\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"cursor-move\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"x\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    updated \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`      socket\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":x\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":y\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":noreply\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" updated\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"render\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"assigns\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    ~\",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"\"\"\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    <ul class=\"list-none\" id=\"cursors\" phx-hook=\"TrackClientCursor\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token string\",children:['      <li style={\"color: deeppink; left: ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@x\"}),(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),\"%; top: \",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@y\"}),(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),`%\"} class=\"flex flex-col absolute pointer-events-none whitespace-nowrap overflow-hidden\">\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <svg\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        version=\"1.1\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        width=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        height=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        xmlns=\"http://www.w3.org/2000/svg\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        viewBox=\"0 0 21 21\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          fill=\"black\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          points=\"8.2,20.9 8.2,4.9 19.8,16.5 13,16.5 12.6,16.6\" />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          fill=\"currentColor\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          points=\"9.2,7.3 9.2,18.5 12.2,15.6 12.6,15.5 17.4,15.5\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        </svg>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <span style={\"background-color: deeppink;\"} class=\"mt-1 ml-4 px-1 text-sm text-white\"><%= @user %></span>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      </li>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    </ul>\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'    \"\"\"'}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Restart the server and open the browser. You should see the pink cursor again, but this time with a random name assigned to it. This name should persist between page refreshes and when you close the browser (it is stored in a cookie).\"}),`\n`,(0,n.jsx)(s,{href:\"https://github.com/vnglst/liveview_cursors/commit/0cc3b3578d5366378be369e7e53e46e1a8ceb9c8\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"tracking-whos-online\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#tracking-whos-online\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Tracking who's online\"]}),`\n`,(0,n.jsx)(e.p,{children:\"We'll be using Phoenix Presence to keep track of who's online in the channel. We'll store information about the user (coordinates and name) in the Presence channel. First, add Presence to our application. We can use the Phoenix generator for this:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"language-bash code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`mix phx.gen.presence\n`})})}),`\n`,(0,n.jsx)(e.p,{children:\"Make sure to also follow the instructions after executing the generator. Take a look at the waypoint below if you get stuck.\"}),`\n`,(0,n.jsx)(s,{href:\"https://github.com/vnglst/liveview_cursors/commit/7d70e848b63dfc46c2e2d84e2f81599d626caa8d\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"The next step in the tutorial will be the most difficult one. The good thing is: to make this work we only need to make changes in our LiveView in \",(0,n.jsx)(e.code,{children:\"cursors.ex\"}),\". Let's break it down:\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"In the mount function of our LiveView we'll initialize Presence for our channel by executing \",(0,n.jsx)(e.code,{children:\"Presence.track\"}),\". In the body of the function, we'll specify the initial values for the current user. Make the following changes:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"defmodule\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Cursors\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"alias\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Presence\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"use\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":live_view\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@cursorview\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"cursorview\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mount\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"_params\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"user\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Presence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"track\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"self\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@cursorview\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"socket_id:\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"x:\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"50\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"y:\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"50\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"name:\"}),` user\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Endpoint\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"subscribe\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@cursorview\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"    initial_users \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Presence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"list\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@cursorview\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Enum\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"_\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":metas\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"List\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"first\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    updated \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`      socket\n`}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":user\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":users\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" initial_users\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":socket_id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":ok\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" updated\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"At the end of the \",(0,n.jsx)(e.code,{children:\"mount\"}),\" function, we're assigning the user, the list of users currently present and the socket id to the LiveView socket. We'll be using that information to render the list of users in the LiveView. Update the \",(0,n.jsx)(e.code,{children:\"render\"}),\" function at the bottom of the file with the following:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"render\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"assigns\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  ~\",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"\"\"\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`  <ul class=\"list-none\" id=\"cursors\" phx-hook=\"TrackClientCursor\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    <%= for user <- @users do %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsxs)(e.span,{className:\"token string\",children:['      <li style={\"color: deeppink; left: ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"x\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),\"%; top: \",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"y\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),`%\"} class=\"flex flex-col absolute pointer-events-none whitespace-nowrap overflow-hidden\">\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <svg\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        version=\"1.1\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        width=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        height=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        xmlns=\"http://www.w3.org/2000/svg\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        viewBox=\"0 0 21 21\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          fill=\"black\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          points=\"8.2,20.9 8.2,4.9 19.8,16.5 13,16.5 12.6,16.6\" />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          fill=\"currentColor\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          points=\"9.2,7.3 9.2,18.5 12.2,15.6 12.6,15.5 17.4,15.5\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        </svg>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <span style={\"background-color: deeppink;\"} class=\"mt-1 ml-4 px-1 text-sm text-white\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <%= user.name %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        </span>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      </li>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    <% end %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`  </ul>\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'  \"\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"We're now also able to properly handle the \",(0,n.jsx)(e.code,{children:\"cursor-move\"}),\" events coming from the client. If we receive this event we'll update the coordinates in the list of users in the Presence channel with the \",(0,n.jsx)(e.code,{children:\"socket.id\"}),\" as an identifier. The code for this is as follows:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"handle_event\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"cursor-move\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"x\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  key \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`id\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"x:\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"y:\"}),\" y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  metas \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Presence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"get_by_key\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@cursorview\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":metas\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"List\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"first\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"merge\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"payload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Presence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"update\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"self\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@cursorview\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" metas\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":noreply\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"The only thing left to do is make sure we update our LiveView the moment a user leaves or joins the channel. All we need to do for this is synchronize the LiveView socket with the information available in the Presence channel. The code for this is as follows:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"handle_info\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"event:\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"presence_diff\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"payload:\"}),\" _payload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  users \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Presence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"list\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@cursorview\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Enum\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"_\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":metas\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"List\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"first\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  updated \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    socket\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"users:\"}),\" users\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"assign\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"socket_id:\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":noreply\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" updated\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Phew! Let's see if that worked. Restart the server and open the browser. You should see the pink cursor again. To verify that multiple users are tracked correctly open up another browser window \",(0,n.jsx)(e.strong,{children:\"either in a different browser or in private mode\"}),\". We need to make sure that we create a new session. Otherwise, you'll just see two you's.\"]}),`\n`,(0,n.jsx)(s,{href:\"https://github.com/vnglst/liveview_cursors/commit/68e580a755d0d8c52257d481e79e3602f8ffd4c2\"}),`\n`,(0,n.jsx)(l,{alt:\"Screenshot of multiple users with Presence\",src:\"/static/screenshots/phoenix-liveview-presence.jpg\",width:1300,height:1346}),`\n`,(0,n.jsxs)(e.h2,{id:\"adding-colors\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#adding-colors\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Adding colors\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"We've now completed the most difficult part of this tutorial. The only thing left to do is some finishing touches. Let's make sure every user has a unique color based on his or her name. Let's create a function that returns a color based on the name of the user in \",(0,n.jsx)(e.code,{children:\"lib/liveview_cursors/colors.ex\"}),\":\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"defmodule\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"LiveviewCursorsWeb\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Colors\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"getHSL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    hue \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"to_charlist\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Enum\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"sum\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"rem\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"360\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token string\",children:['\"hsl(',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"hue\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),', 70%, 40%)\"']}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Instead of using \",(0,n.jsx)(e.code,{children:\"deeppink\"}),\" as the color for every user, we use the calculated color instead:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"render\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"assigns\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    ~\",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"\"\"\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    <ul class=\"list-none\" id=\"cursors\" phx-hook=\"TrackClientCursor\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      <%= for user <- @users do %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <% color = getHSL(user.name) %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsxs)(e.span,{className:\"token string\",children:['        <li style={\"color: ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"color\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),\"; left: \",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"x\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),\"%; top: \",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"y\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),`%\"} class=\"flex flex-col absolute pointer-events-none whitespace-nowrap overflow-hidden\">\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <svg\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          version=\"1.1\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          width=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          height=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          xmlns=\"http://www.w3.org/2000/svg\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          viewBox=\"0 0 21 21\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            fill=\"black\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            points=\"8.2,20.9 8.2,4.9 19.8,16.5 13,16.5 12.6,16.6\" />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            fill=\"currentColor\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            points=\"9.2,7.3 9.2,18.5 12.2,15.6 12.6,15.5 17.4,15.5\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          </svg>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsxs)(e.span,{className:\"token string\",children:['          <span style={\"background-color: ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"color\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),`;\"} class=\"mt-1 ml-4 px-1 text-sm text-white\">\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            <%= user.name %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          </span>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        </li>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      <% end %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    </ul>\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'    \"\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Don't forget to import the module in the \",(0,n.jsx)(e.code,{children:\"defmodule\"}),\" block using \",(0,n.jsx)(e.code,{children:\"import LiveviewCursorsWeb.Colors\"}),\". If you restart the server you should see a different color for each user.\"]}),`\n`,(0,n.jsx)(s,{href:\"https://github.com/vnglst/liveview_cursors/commit/5a69d68504d1ce03a975b0b5acf6edb9fe878ec3\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"sending-messages\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#sending-messages\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Sending messages\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Before users can send messages, we have to add a web form with input and submit elements. This is where Phoenix LiveView shines. If you add a \",(0,n.jsx)(e.code,{children:\"phx-submit\"}),\" binding to the form, any submits are automatically sent to the server as an event. The code for this is as follows:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"render\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"assigns\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  ~\",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"\"\"\n`})]}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    <section class=\"flex flex-col w-screen h-screen justify-center items-center text-center\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      <form\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      id=\"msgform\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      phx-submit=\"send_message\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      class=\"rounded-xl bg-gradient-to-r to-pink-100 from-pink-50 p-8 drop-shadow-xl flex w-xs mx-auto space-x-3\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      >\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <input\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          class=\"flex-1 appearance-none border border-transparent py-2 px-4 bg-white text-gray-600 placeholder-gray-400 shadow-md rounded-lg text-base focus:outline-none focus:ring-2 focus:ring-pink-600 focus:border-transparent\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          maxlength=\"30\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          aria-label=\"Your message\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          type=\"text\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          id=\"msg\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          name=\"msg\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          placeholder=\"Say something\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        />\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <input\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          id=\"submit-msg\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          type=\"submit\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          class=\"flex-shrink-0 bg-pink-600 text-white text-base font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 focus:ring-offset-pink-200\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          value=\"Change\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        />\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      </form>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      <ul class=\"list-none\" id=\"cursors\" phx-hook=\"TrackClientCursor\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <%= for user <- @users do %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          <% color = getHSL(user.name) %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token string\",children:['          <li style={\"color: ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"color\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),\"; left: \",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"x\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),\"%; top: \",(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"y\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),`%\"} class=\"flex flex-col absolute pointer-events-none whitespace-nowrap overflow-hidden\">\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            <svg\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            version=\"1.1\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            width=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            height=\"25px\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            xmlns=\"http://www.w3.org/2000/svg\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            viewBox=\"0 0 21 21\">\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`              <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`              fill=\"black\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`              points=\"8.2,20.9 8.2,4.9 19.8,16.5 13,16.5 12.6,16.6\" />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`              <polygon\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`              fill=\"currentColor\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`              points=\"9.2,7.3 9.2,18.5 12.2,15.6 12.6,15.5 17.4,15.5\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`              />\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            </svg>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token string\",children:['            <span style={\"background-color: ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"color\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),`;\"} class=\"mt-1 ml-4 px-1 text-sm text-white w-fit\">\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`              <%= user.name %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            </span>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsxs)(e.span,{className:\"token string\",children:['            <span style={\"background-color: ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"#{\"}),\"color\",(0,n.jsx)(e.span,{className:\"token delimiter punctuation\",children:\"}\"})]}),`;\"} class=\"text-green-50 mt-1 py-0 px-1 text-sm text-left rounded-br-md opacity-80 fit-content\">\n`]})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`              <%= user.msg %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`            </span>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`          </li>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`        <% end %>\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`      </ul>\n`})}),(0,n.jsx)(e.span,{className:\"code-line highlight-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`    </section>\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'    \"\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"To avoid duplicating the code for updating a user in Presence we'll create a helper function \",(0,n.jsx)(e.code,{children:\"updatePresence\"}),\" and we'll call that from our event handlers.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"handle_event\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"cursor-move\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"x\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"y\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    key \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`id\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"x:\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"y:\"}),\" y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"updatePresence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"x:\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"y:\"}),\" y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":noreply\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"handle_event\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"send_message\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"msg\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" msg\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"updatePresence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"msg:\"}),\" msg\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":noreply\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"updatePresence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    metas \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Presence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"get_by_key\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@cursorview\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token atom symbol\",children:\":metas\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"List\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"first\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|>\"}),\" \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"merge\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"payload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Presence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"update\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"self\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@cursorview\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" metas\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"end\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"When mounting the LiveView we also have to initialize the user message:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-elixir\",children:(0,n.jsxs)(e.code,{className:\"language-elixir code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mount\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"_params\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"user\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=>\"}),\" user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"do\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token module class-name\",children:\"Presence\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"track\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"self\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token attribute variable\",children:\"@cursorview\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"socket_id:\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"x:\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"50\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"y:\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"50\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line highlight-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"msg:\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"name:\"}),` user\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# ...\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"If you restart the server and open up a few tabs (in different browsers) you should see the following result:\"}),`\n`,(0,n.jsx)(s,{href:\"https://github.com/vnglst/liveview_cursors/commit/cc65084342e87322a7e52a46632e965dc98c8101\"}),`\n`,(0,n.jsx)(l,{alt:\"Screenshot of the end result\",src:\"/static/screenshots/phoenix-live-cursors.jpg\",width:2152,height:1372}),`\n`,(0,n.jsxs)(e.h2,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This concludes my tutorial in which I recreated the live cursors functionality using LiveView. Comparing this with my earlier approach where a large part of the implementation was happening on the client using JavaScript I found that LiveView offers considerable advantages:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"all the code that makes the feature work, lives on the server\"}),`\n`,(0,n.jsx)(e.li,{children:\"this means there's minimal switching between Elixir and JavaScript\"}),`\n`,(0,n.jsx)(e.li,{children:\"you can update HTML + Tailwind classes close to where the data lives\"}),`\n`,(0,n.jsx)(e.li,{children:\"so that code that frequently changes together, also lives close together\"}),`\n`,(0,n.jsx)(e.li,{children:\"somehow this feels familiar to me as a React developer\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"I hope you enjoyed this tutorial and if you have any questions or comments feel free to send me a message on Twitter using the link below. Any kind of feedback (tips, improvements, ideas) is appreciated.\"})]})}function p(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,{...a,children:(0,n.jsx)(h,{...a})}):h(a)}function t(a,e){throw new Error(\"Expected \"+(e?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return v(x);})();\n;return Component;",
  "readingTime": {
    "text": "14 min read",
    "minutes": 13.66,
    "time": 819600,
    "words": 2732
  }
}